a local modified version of figuregen